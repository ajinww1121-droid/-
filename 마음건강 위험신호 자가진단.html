<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë§ˆìŒê±´ê°• ìœ„í—˜ì‹ í˜¸ ìê°€ì§„ë‹¨</title>
<link rel="icon" href="í–¥ì¼ê³ ë“±í•™êµ.png" type="image/png">
<style>
  * { box-sizing: border-box; }
  
  body { 
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
    background: #f5f7fa;
    margin: 0; 
    padding: 20px;
    min-height: 100vh;
  }
  
  .container { 
    max-width: 600px; 
    margin: auto; 
    background: #fff; 
    padding: 40px 30px; 
    border-radius: 16px; 
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
  }
  
  h1 { 
    text-align: center; 
    color: #2c3e50;
    margin-bottom: 10px;
    font-size: 1.8em;
    font-weight: 700;
  }
  
  .subtitle {
    text-align: center;
    color: #7f8c8d;
    font-size: 0.95em;
    margin-bottom: 30px;
  }
  
  .user-id-section {
    margin-bottom: 30px;
    padding: 20px;
    background: #e8f4f8;
    border-radius: 12px;
    border-left: 4px solid #3498db;
  }
  
  .user-id-section label {
    font-weight: 600;
    color: #2c3e50;
    display: block;
    margin-bottom: 8px;
  }
  
  .user-id-section input {
    width: 100%;
    padding: 12px 15px;
    border: 2px solid #bdc3c7;
    border-radius: 8px;
    font-size: 1em;
  }
  
  .user-id-section .note {
    font-size: 0.85em;
    color: #7f8c8d;
    margin-top: 8px;
    display: block;
  }
  
  .input-group {
    margin-bottom: 30px;
    padding: 20px;
    background: #fafbfc;
    border-radius: 12px;
    border: 1px solid #e1e4e8;
  }
  
  label { 
    font-weight: 600; 
    display: block; 
    margin-bottom: 8px;
    color: #2c3e50;
    font-size: 1.05em;
  }
  
  .note { 
    font-weight: normal; 
    font-size: 0.85em; 
    color: #6c757d;
    display: block;
    margin-top: 5px;
    line-height: 1.5;
  }
  
  input[type=number] { 
    width: 100%; 
    padding: 12px 15px;
    border: 2px solid #dee2e6;
    border-radius: 8px;
    font-size: 1.1em;
    transition: all 0.3s ease;
    font-family: inherit;
  }
  
  input[type=number]:focus {
    outline: none;
    border-color: #3498db;
    box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
  }
  
  input[type=range] { 
    width: 100%; 
    margin: 15px 0 8px 0;
    -webkit-appearance: none; 
    height: 8px; 
    border-radius: 4px; 
    background: #e1e4e8;
    outline: none;
  }
  
  input[type=range]::-webkit-slider-thumb { 
    -webkit-appearance: none; 
    appearance: none; 
    width: 22px; 
    height: 22px; 
    border-radius: 50%; 
    background: #3498db;
    cursor: pointer; 
    box-shadow: 0 2px 6px rgba(52, 152, 219, 0.4);
    transition: all 0.2s ease;
  }
  
  input[type=range]::-webkit-slider-thumb:hover {
    transform: scale(1.15);
    box-shadow: 0 3px 10px rgba(52, 152, 219, 0.6);
  }
  
  input[type=range]::-moz-range-thumb { 
    width: 22px; 
    height: 22px; 
    border-radius: 50%; 
    background: #3498db;
    cursor: pointer;
    border: none;
    box-shadow: 0 2px 6px rgba(52, 152, 219, 0.4);
    transition: all 0.2s ease;
  }
  
  input[type=range]::-moz-range-thumb:hover {
    transform: scale(1.15);
    box-shadow: 0 3px 10px rgba(52, 152, 219, 0.6);
  }
  
  .value-display {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 5px;
  }
  
  .current-value {
    font-size: 1.3em;
    font-weight: 700;
    color: #3498db;
    background: #e8f4f8;
    padding: 5px 15px;
    border-radius: 20px;
  }
  
  .value-label {
    font-size: 0.9em;
    color: #6c757d;
  }
  
  .ticks { 
    display: flex; 
    justify-content: space-between; 
    font-size: 0.75em; 
    color: #adb5bd;
    margin-top: 5px;
    padding: 0 2px;
  }
  
  button { 
    width: 100%; 
    padding: 16px; 
    margin-top: 30px; 
    background: #3498db;
    color: white; 
    border: none; 
    border-radius: 8px; 
    font-size: 1.1em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  button:hover { 
    background: #2980b9;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
  }
  
  button:active {
    transform: translateY(0);
  }
  
  .result-container {
    margin-top: 30px;
    padding: 25px;
    background: #f8f9fa;
    border-radius: 12px;
    text-align: center;
    display: none;
    border: 2px solid #e1e4e8;
  }
  
  .result-container.show {
    display: block;
    animation: fadeIn 0.5s ease;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .result { 
    font-size: 1.5em; 
    font-weight: 700;
    color: #2c3e50;
    margin-bottom: 15px;
  }
  
  .result-score {
    font-size: 2em;
    color: #3498db;
  }
  
  .category { 
    margin-top: 15px; 
    font-size: 1.3em; 
    font-weight: 700;
    padding: 15px 25px;
    border-radius: 8px;
    color: white;
    display: inline-block;
  }
  
  .comparison-box {
    margin-top: 20px;
    padding: 15px;
    background: #fff;
    border-radius: 8px;
    border-left: 4px solid #3498db;
  }
  
  .comparison-box h4 {
    margin: 0 0 10px 0;
    color: #2c3e50;
    font-size: 1em;
  }
  
  .comparison-box p {
    margin: 5px 0;
    color: #495057;
    font-size: 0.95em;
  }
  
  .comparison-increase {
    color: #e74c3c;
    font-weight: 700;
  }
  
  .comparison-decrease {
    color: #27ae60;
    font-weight: 700;
  }
  
  .comparison-same {
    color: #7f8c8d;
    font-weight: 700;
  }
  
  .advice-message {
    margin-top: 15px;
    padding: 15px 20px;
    background: #fff;
    border-radius: 8px;
    color: #2c3e50;
    font-size: 0.95em;
    line-height: 1.6;
    border-left: 4px solid;
  }
  
  .general-warning {
    margin-top: 15px;
    padding: 15px;
    background: #fff3cd;
    border-radius: 8px;
    border-left: 4px solid #ffc107;
    font-size: 0.9em;
    color: #856404;
    line-height: 1.6;
  }
  
  .emergency-help {
    margin-top: 20px;
    padding: 25px;
    background: #ffe0e0;
    border-radius: 12px;
    border: 2px solid #e74c3c;
    color: #721c24;
    text-align: center;
    display: none;
  }
  
  .emergency-help.show {
    display: block;
  }
  
  .emergency-help h3 {
    margin: 0 0 15px 0;
    font-size: 1.3em;
    color: #e74c3c;
  }
  
  .emergency-help p {
    margin: 10px 0;
    font-size: 1em;
    line-height: 1.6;
  }
  
  .help-button {
    display: inline-block;
    margin-top: 15px;
    padding: 15px 30px;
    background: #e74c3c;
    color: white;
    text-decoration: none;
    border-radius: 8px;
    font-weight: 700;
    font-size: 1.1em;
    transition: all 0.3s ease;
  }
  
  .help-button:hover {
    background: #c0392b;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
  }
  
  .disclaimer { 
    font-size: 0.85em; 
    color: #6c757d;
    margin-top: 25px; 
    text-align: center;
    line-height: 1.6;
    padding: 15px;
    background: #fff3cd;
    border-radius: 8px;
    border-left: 4px solid #ffc107;
  }
  
  .icon {
    display: inline-block;
    margin-right: 8px;
  }
</style>
</head>
<body>

<div class="container">
  <h1>ğŸ§  ë§ˆìŒê±´ê°• ìœ„í—˜ì‹ í˜¸ ìê°€ì§„ë‹¨</h1>
  <p class="subtitle">ìµœê·¼ 1ì£¼ì¼ê°„ì˜ ìƒíƒœë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
 
  <div class="user-id-section">
    <label for="userId"><span class="icon">ğŸ”‘</span>ìµëª… ë‹‰ë„¤ì„ (ì„ íƒ)</label>
    <input type="text" id="userId" placeholder="ì˜ˆ: student123 ë˜ëŠ” teacher01">
    <span class="note">ì´ì „ ê²°ê³¼ì™€ ë¹„êµí•˜êµ ì‹¶ë‹¤ë©´ ê°™ì€ ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”. ê°œì¸ì •ë³´ëŠ” ì €ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</span>
  </div>

  <div class="input-group">
    <label for="age"><span class="icon">ğŸ‘¤</span>ë‚˜ì´</label>
    <input type="number" id="age" value="20" min="10" max="70">
  </div>

  <div class="input-group">
    <label for="support">
      <span class="icon">ğŸ¤</span>ì‚¬íšŒì  ì§€ì§€ ìˆ˜ì¤€
      <span class="note">ê°œì¸ì—ê²Œ ì–´ë ¤ì›€ì´ ìˆì„ ë•Œ ê°€ì¡±, ì¹œêµ¬, ë™ë£Œ ë“± ì‚¬íšŒì  ê´€ê³„ë§ì„ í†µí•´ ë°›ëŠ” ì •ì„œì , ë¬¼ì§ˆì , ì •ë³´ì  ì¸¡ë©´ì˜ ê¸ì •ì ì¸ ë„ì›€ ìˆ˜ì¤€ (10ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ê¸ì •ì )</span>
    </label>
    <div class="value-display">
      <span class="value-label">ë‚®ìŒ</span>
      <span class="current-value" id="supportVal">5</span>
      <span class="value-label">ë†’ìŒ</span>
    </div>
    <input type="range" id="support" min="1" max="10" value="5" step="1">
    <div class="ticks">
      <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
    </div>
  </div>

  <div class="input-group">
    <label for="sleep"><span class="icon">ğŸ˜´</span>ìˆ˜ë©´ì‹œê°„</label>
    <div class="value-display">
      <span class="value-label">ë¶€ì¡±</span>
      <span class="current-value" id="sleepVal">7</span>
      <span class="value-label">ì¶©ë¶„</span>
    </div>
    <input type="range" id="sleep" min="0" max="12" value="7" step="0.5">
    <div class="ticks">
      <span>0h</span><span>2h</span><span>4h</span><span>6h</span><span>8h</span><span>10h</span><span>12h</span>
    </div>
    <div class="value-label" id="sleepText" style="text-align: center; margin-top: 8px; font-size: 1em; color: #495057;">7ì‹œê°„ 0ë¶„</div>
  </div>

  <div class="input-group">
    <label for="stress">
      <span class="icon">ğŸ˜°</span>ìŠ¤íŠ¸ë ˆìŠ¤ ì§€ìˆ˜
      <span class="note">10ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ë§¤ìš° ë†’ì€ ìŠ¤íŠ¸ë ˆìŠ¤ ìƒíƒœ</span>
    </label>
    <div class="value-display">
      <span class="value-label">ë‚®ìŒ</span>
      <span class="current-value" id="stressVal">5</span>
      <span class="value-label">ë†’ìŒ</span>
    </div>
    <input type="range" id="stress" min="1" max="10" value="5" step="1">
    <div class="ticks">
      <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
    </div>
  </div>

  <button onclick="calculateR()">ğŸ“Š ê²°ê³¼ ê³„ì‚°í•˜ê¸°</button>

  <div class="result-container" id="resultContainer">
    <div class="result">
      ìœ„í—˜ì§€ìˆ˜: <span class="result-score" id="resultScore">0</span>
    </div>
    <div class="category" id="category"></div>
    
    <div class="comparison-box" id="comparisonBox" style="display: none;">
      <h4>ğŸ“ˆ ì´ì „ ê²°ê³¼ì™€ ë¹„êµ</h4>
      <p id="comparisonText"></p>
    </div>
    
    <div class="advice-message" id="adviceMessage"></div>
    
    <div class="general-warning" id="generalWarning" style="display: none;">
      âš ï¸ ì ìˆ˜ì™€ ê´€ê³„ì—†ì´ ê·¹ë‹¨ì ì¸ ìƒê°ì´ë‚˜ ì‹¬ê°í•œ ìŠ¤íŠ¸ë ˆìŠ¤ ë° ë¶ˆì•ˆì´ ì§€ì†ë˜ëŠ” ê²½ìš°, ì¦‰ì‹œ ì „ë¬¸ê°€ì˜ ë„ì›€ì„ ë°›ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
    </div>
  </div>

  <div class="emergency-help" id="emergencyHelp">
    <h3>ğŸ†˜ ì¦‰ì‹œ ë„ì›€ì´ í•„ìš”í•©ë‹ˆë‹¤</h3>
    <p>í˜¼ì í•´ê²°í•˜ë ¤ê³  í•˜ì§€ ì•Šì•„ë„ ê´œì°®ìŠµë‹ˆë‹¤.<br>ë‹¹ì‹ ì„ ë„ìš¸ ìˆ˜ ìˆëŠ” ì „ë¬¸ê°€ë“¤ì´ ê³ì— ìˆìŠµë‹ˆë‹¤.</p>
    <a href="https://www.129.go.kr/109" target="_blank" class="help-button">
      ğŸŒ ë³´ê±´ë³µì§€ìƒë‹´ì„¼í„° ë°”ë¡œê°€ê¸°
    </a>
    <p style="margin-top: 15px; font-size: 0.9em;">ì „í™” ìƒë‹´: êµ­ë²ˆì—†ì´ <strong>109</strong></p>
  </div>

  <p class="disclaimer">
    âš ï¸ ë³¸ í”„ë¡œê·¸ë¨ì˜ ì§„ë‹¨ ê²°ê³¼ëŠ” ì°¸ê³ ìš©ì´ë©°, ì ˆëŒ€ì  ì§„ë‹¨ ê²°ê³¼ë¥¼ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë” ìì„¸í•˜ê³  ì •í™•í•œ ì§„ë‹¨ì€ ì „ë¬¸ ì˜ë£Œê¸°ê´€ì„ í†µí•œ ìƒë‹´ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
  </p>
</div>

<script>
  // Enter í‚¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
  document.addEventListener('keypress', function(event) {
    if (event.key === 'Enter') {
      calculateR();
    }
  });

  const supportSlider = document.getElementById('support');
  const supportVal = document.getElementById('supportVal');
  supportSlider.oninput = () => supportVal.textContent = supportSlider.value;

  const sleepSlider = document.getElementById('sleep');
  const sleepVal = document.getElementById('sleepVal');
  const sleepText = document.getElementById('sleepText');
  sleepSlider.oninput = () => {
    sleepVal.textContent = sleepSlider.value;
    const hours = Math.floor(sleepSlider.value);
    const minutes = (sleepSlider.value - hours) * 60;
    sleepText.textContent = `${hours}ì‹œê°„ ${minutes===0?0:30}ë¶„`;
  };

  const stressSlider = document.getElementById('stress');
  const stressVal = document.getElementById('stressVal');
  stressSlider.oninput = () => stressVal.textContent = stressSlider.value;

  // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì´ì „ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
  function getPreviousData(userId) {
    if (!userId) return null;
    const saved = localStorage.getItem('mentalHealth_' + userId);
    return saved ? JSON.parse(saved) : null;
  }

  // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„° ì €ì¥
  function saveData(userId, score, date) {
    if (!userId) return;
    const data = { score: score, date: date };
    localStorage.setItem('mentalHealth_' + userId, JSON.stringify(data));
  }

  function calculateR() {
    // ë¨¼ì € ê¸´ê¸‰ ë„ì›€ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
    document.getElementById('emergencyHelp').classList.remove('show');
    document.getElementById('generalWarning').style.display = 'none';
    document.getElementById('comparisonBox').style.display = 'none';
    
    const A = Number(document.getElementById('age').value);
    const G = Number(document.getElementById('support').value);
    const H = Number(document.getElementById('sleep').value);
    const S = Number(document.getElementById('stress').value);
    const userId = document.getElementById('userId').value.trim();

    // ê°€ì¤‘ì¹˜
    const wStress = 0.34;
    const wSleep = 0.27;
    const wSupport = 0.34;
    const wAge = 0.05;

    // ìŠ¤íŠ¸ë ˆìŠ¤
    const S_norm = (S-1)/9;

    // ìˆ˜ë©´ ìœ„í—˜ (6~8 ì‹œê°„ êµ¬ê°„ ì•ˆì „)
    const a1 = (6-H)/6;
    const b1 = (H-8)/4;
    const m1 = (a1+b1+Math.abs(a1-b1))/2;
    const H_risk = (m1 + Math.abs(m1))/2;

    // ì‚¬íšŒì  ì§€ì§€ ë°˜ì „
    const G_norm = (10-G)/9;

    // ë‚˜ì´ ìœ„í—˜: 10~25, 45~50 ì¦ê°€, 26~44 ì œì™¸
    const a2 = (30-A)/20;
    const b2 = (A-45)/5;
    const m2 = (a2+b2+Math.abs(a2-b2))/2;
    let A_risk = (m2+Math.abs(m2))/2;
    A_risk = Math.min(Math.max(A_risk,0),1);

    // ìµœì¢… R
    let R = 100*(wStress*S_norm + wSleep*H_risk + wSupport*G_norm + wAge*A_risk);
    R = Math.min(Math.max(R,0),100);

    // ì´ì „ ë°ì´í„°ì™€ ë¹„êµ
    if (userId) {
      const previousData = getPreviousData(userId);
      if (previousData) {
        const diff = R - previousData.score;
        const diffAbs = Math.abs(diff);
        const comparisonBox = document.getElementById('comparisonBox');
        const comparisonText = document.getElementById('comparisonText');
        
        comparisonBox.style.display = 'block';
        
        if (diffAbs < 0.5) {
          comparisonText.innerHTML = `ì´ì „ê³¼ <span class="comparison-same">ë¹„ìŠ·í•œ ìˆ˜ì¤€</span>ì…ë‹ˆë‹¤.`;
        } else if (diff > 0) {
          comparisonText.innerHTML = `ì´ì „ë³´ë‹¤ ìœ„í—˜ ìš”ì¸ì´ <span class="comparison-increase">${diffAbs.toFixed(1)}ì  ì¦ê°€</span>í–ˆìŠµë‹ˆë‹¤.`;
        } else {
          comparisonText.innerHTML = `ì´ì „ë³´ë‹¤ <span class="comparison-decrease">${diffAbs.toFixed(1)}ì  ê°œì„ </span>ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‘`;
        }
      }
      
      // í˜„ì¬ ë°ì´í„° ì €ì¥
      saveData(userId, R, new Date().toISOString());
    }

    document.getElementById('resultScore').textContent = R.toFixed(1);

    let catText = '';
    let color = '';
    let emoji = '';
    let adviceText = '';
    let adviceColor = '';
    let showGeneralWarning = false;
    
    if(R <= 40){ 
      catText='ì •ìƒ(Normal)'; 
      color='#3498db'; 
      emoji='âœ…';
      adviceText = 'ì§€ê¸ˆì²˜ëŸ¼ ê±´ê°•ì„ ìœ ì§€í•˜ë ¤ë©´ ê·œì¹™ì ì¸ ìˆ˜ë©´ê³¼ ì·¨ë¯¸ í™œë™ì´ ë„ì›€ì´ ë©ë‹ˆë‹¤.';
      adviceColor = '#3498db';
      showGeneralWarning = true;
    }
    else if(R <= 55){ 
      catText='ì£¼ì˜(Caution)'; 
      color='#2ecc71'; 
      emoji='âš ï¸';
      adviceText = 'ìµœê·¼ ê°ì • ë³€í™”ë¥¼ ë¬´ì‹œí•˜ì§€ ë§ê³  íšŒë³µì— ì‹ ê²½ì¨ë³´ì„¸ìš”. í•˜ë£¨ 10ë¶„ ì‚°ì±…ë„ íš¨ê³¼ì ì…ë‹ˆë‹¤.';
      adviceColor = '#2ecc71';
      showGeneralWarning = true;
    }
    else if(R <= 75){ 
      catText='ìœ„í—˜(Risk)'; 
      color='#e67e22'; 
      emoji='ğŸš¨';
      adviceText = 'ì§€ê¸ˆì˜ ê°ì •ì€ í˜¼ì ê°ë‹¹í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤. ì „ë¬¸ ê¸°ê´€ê³¼ ì—°ê²°í•´ ë„ì›€ì„ ë°›ì•„ë³´ì„¸ìš”.';
      adviceColor = '#e67e22';
      showGeneralWarning = true;
    }
    else{ 
      catText='ê³ ìœ„í—˜(High Risk)'; 
      color='#e74c3c'; 
      emoji='ğŸ”´';
      adviceText = 'ì¦‰ì‹œ ì „ë¬¸ê°€ì˜ ë„ì›€ì´ í•„ìš”í•œ ìƒí™©ì…ë‹ˆë‹¤. ì•„ë˜ ì—°ë½ì²˜ë¥¼ í†µí•´ ì§€ê¸ˆ ë°”ë¡œ ì—°ê²°í•˜ì„¸ìš”.';
      adviceColor = '#e74c3c';
      document.getElementById('emergencyHelp').classList.add('show');
    }

    const catDiv = document.getElementById('category');
    catDiv.textContent = `${emoji} ${catText}`;
    catDiv.style.backgroundColor = color;
    
    const adviceDiv = document.getElementById('adviceMessage');
    adviceDiv.textContent = adviceText;
    adviceDiv.style.borderLeftColor = adviceColor;
    
    if (showGeneralWarning) {
      document.getElementById('generalWarning').style.display = 'block';
    }
    
    document.getElementById('resultContainer').classList.add('show');
    document.getElementById('resultContainer').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }

  // ì´ˆê¸° í‘œì‹œ ì—…ë°ì´íŠ¸
  sleepSlider.oninput();
</script>

</body>
</html>